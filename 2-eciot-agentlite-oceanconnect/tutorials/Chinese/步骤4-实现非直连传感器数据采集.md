# 非直连传感器数据采集

传感数据采集属于通用的嵌入式开发范畴，并非我们要讨论的重点，这里我们提供Demo以虚拟数据模拟上报到OceanConnect，并接收控制指令。

将样例代码解压

1、`while`语句中将间隔1秒钟周期上报存储的LedIdx

```c
HW_INT main()
{
...
    while(1)  
    {  
        if(g_uiLoginFlg && strlen(g_cSensorId)>0)
        {
            Device_ReportIdx(&pcJsonStr);
            Device_ServiceDataReport(g_cSensorId, IOTA_SERVICE_LEDCHAR, pcJsonStr);
            HW_LOG_INF(" --Device_ServiceDataReport--:%s, value:%d", g_cSensorId, g_uiCurLedIdx);
        }

        HW_Sleep(1);
    }
}

HW_INT Device_ReportIdx( HW_CHAR **pcJsonStr)
{
    HW_JSON json;
    HW_JSONOBJ hJsonObj;
    
    hJsonObj = HW_JsonObjCreate();
    json = HW_JsonGetJson(hJsonObj); 
    if (g_bRollStatus)
    {
        g_uiCurLedIdx = (g_uiCurLedIdx+1)%100;
    }
    HW_JsonAddUint(json, (HW_CHAR*)"curledidx", (HW_INT)g_uiCurLedIdx);
    *pcJsonStr = HW_JsonEncodeStr(hJsonObj);
    
    return HW_OK;
}
```